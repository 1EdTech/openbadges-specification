<!DOCTYPE html lang="en">
<html>
  <head>
    <meta charset='utf-8'>
    <script src='https://purl.imsglobal.org/spec/respec-ims-default.js' async class='remove'></script>
    <script src='./shared/local-biblio.js' class='remove'></script>
    <script src='local-biblio.js' class='remove'></script>
    <script class='remove'>
      var respecConfig = {
        specTitle: "Badge Connect API",
        shortName: "ob-connect",
        specStatus: "IMS Base Document",
        specDate: "Month Day, 2018",
        specVersion: "1.0",
        specNature: "normative",
        specType: "spec",
        contributors: [
          {name: "Alexander Hripak", company: "Credly", companyURL: "https://credly.com", role: "Editor"},
          {name: "Nate Otto", company: "Concentric Sky", companyURL: "https://concentricsky.com", role: "Contributor"},
          {name: "Justin Pitcher", company: "Campus Labs", companyURL: "https://www.campuslabs.com/", role: "Contributor"},
          {name: "Chris Houston", company: "Capella University", companyURL: "https://www.capella.edu/", role: "Contributor"}
        ],
        //localBiblio is used to store bib entries not yet in the online imsBiblio or on specref.org
        localBiblio: _localBiblio
      };
    </script>
  </head>
  <body>

    <section class="introductory" id="abstract">
        <h2>Abstract</h2>
    </section>

    <section>
      <h2>Overview</h2>
      <section class="informative">
        <h3>Design Goals and Rationale</h3>
        <p>The Badge Connect API is a specification that allows badge recipients to easily move their Assertions between platforms to streamline the experience of earning and using Open Badges. The initial scope for this specification will cover Assertions and Profiles, with potential additions in future versions of other types of data held by applications in the various Open Badges ecosystem roles of Issuer, Displayer, and Host.</p>
      </section>

      <section class="informative" id="usecases">
        <h3>Use cases</h3>
        <p>The following use cases are supported by this specification:</p>
        <table>
          <tbody>
            <tr id="usecases-issuer-host-import">
              <td>A recipient of an Assertion wants to import historically-issued badges into a chosen Host from an Issuer platform.</td>
            </tr>
            <tr id="usecases-issuer-host-award">
              <td>A user wishes to authorize an Issuer to push awarded Assertions to their chosen Host upon issue.</td>
            </tr>
            <tr id="usecases-host-displayer-transfer">
              <td>A user wishes to connect their Assertions to a recruiting platform.</td>
            </tr>
            <tr id="usecases-host-host-transfer">
              <td>A user wishes to move their badges from one Host to another Host.</td>
            </tr>
          </tbody>
        </table>
      </section>

      <section id="terminology">
        <h3>Terminology</h3>
        <!-- add each term as a dt/dd pair with attrs as below; then use <a> in when referencing back to a term -->
        <!-- use data-sort to automatically sort the terms -->
        <!-- note that the terminology can be shared between docs using script class=transclude -->
        <dl class="termlist" data-sort id="terms">
          <dt><dfn data-lt="term1">term1</dfn></dt>
          <dd>Definition</dd>
          <dt><dfn data-lt="term2">term2</dfn></dt>
          <dd>Definition</dd>
        </dl>
      </section>
      <section id="conformance">
        <h3>Conformance Statements</h3>
        <!-- RFC 2119 text is inserted at the top of this section.
            If you want, add additional paragraphs below this comment.
        -->
      </section>
      <section id="documentset">
        <h3>Document Set</h3>
        <!-- a complete list of documents in the Specification document set.
        Includes both normative and informative references. All documents
        referenced here also occur in the bibliography-->
        <section>
          <h4>Normative Documents</h4>
          <dl>
          <dt>Conformance and Certification guide</dt>
          <dd>The conformance and certification guide
          that accompanies this specification [[!EXAMPLE-CERT]] defines
          the requirements for template service consumers and providers.
          </dd>
          <dt>JSON Schema</dt>
          <dd>The JSON [[!EXAMPLE-JSONSCH]] schema is provided hendrerit est.
          Proin tempor, quam vitae consequat congue, est sapien pharetra odio,
          sed rhoncus metus sem in turpis. </dd>
          <dt>Errata</dt>
          <dd>The errata [[!EXAMPLE-ERRATA]] details any erratum registered for
            this version of this specification since its publication.</dd>
          </dl>
        </section>
        <section class="informative">
          <h4>Informative Documents</h4>
          <dl>
          <dt>Implementation Guide</dt> <dd>The implementation guide
          that accompanies this specification [[EXAMPLE-IMPL]] contains
          informtative guidance on facilisis hendrerit est. Nullam ultrices
          non libero sed tristique. Proin tempor, quam vitae consequat congue,
          est sapien pharetra odio, sed rhoncus metus sem in turpis. </dd>
          </dl>
          <dl>
          <dt>OpenAPI Swagger View</dt>
          <dd>A browseable view of the OpenAPI definition is available at...</dd>
          </dl>
        </section>
      </section>
    </section> <!-- /overview -->

    <section>
      <h2>API</h2>
      <p>Badge Connect defines a JSON API protocol to be implemented by applications serving in the
        roles of Host and Relying Party. Typically Relying Parties SHOULD be certified Open Badges
        services in the Open Badges roles of Displayer or Issuer, though Hosts may also be relying
        parties to serve the <a href="#usecases-host-host-transfer">Host to Host transfer use case
        </a>. Badge Connect API uses OAuth 2.0 for authentication, granular resource-based permission
        scopes, and offers a number of required endpoints that MUST be implemented by Hosts and
        Relying Parties or both.
      </p>

      <section id="api-authentication">
        <h3>Authentication</h3>
        <p>A Relying Party requests a token scoped for access to Open Badges Assertions on a Host
          that belong to a user (resource owner) of that Host service, using an OAuth 2.0
          Authorization Code Grant as described in the <a href="#TODO">IMS Security Framework</a>.
          Once a Relying Party obtains a code, it exchanges the code for a token using a signed JWT that
          is verified using an identified public key in a key set. Subsequent API requests are
          authenticated with the access token until its expiration, after which it MAY be renewed if the
          Host supports and provided a refresh token.
        </p>
        <section id="oauth-token">
          <h3>Obtaining Tokens</h3>
          <p>The user starts on the Relying Party service and is offered the chance to connect that
            service to their chosen Host. The user supplies the Relying Party with the Host domain
            authority or selects their Host from a list. The Relying Party then MAY initiate an
            authorization request by redirecting the user to the Host's AuthorizationURI as
            declared in the Host's Open Badge Connect Manifest. This HTTP GET request MUST have a
            <code>redirect_uri</code> query with the absolute URI of the Relying Party's
            redirection endpoint, urlencoded as well as a list of requested scopes from the options
            available, according to the OAuth 2.0 Specification. The required <code>client_id</code>
            parameter MUST be the string <code>BADGE_CONNECT</code>.
          </p>

          <p>If the Host does not recognize the Relying Party's redirection endpoint from a prior
            connection with this Relying Party, the Host SHOULD request the Badge Connect
            Manifest from the Relying Party from the well-known manifest path relative to the
            authority of the provided <code>redirect_uri</code> parameter. If the manifest file is
            valid under the requirements of this specification and the specified redirection
            endpoint appears in the manifest, the Host MAY honor the request to present the
            user/resource owner with the option to authorize the request. If the Host recognizes
            the Relying Party, the Host MAY skip the manifest check for subsequent authorization
            requests. If the user authorizes the Relying Party to access their resources with the
            requested scopes, the Host MUST redirect the user back to the redirect_uri with a
            <code>code</code> query parameter. The Relying Party may use this code in the next step
            to obtain a token.
          </p>

          <p>With a code in hand, the Relying Party SHOULD attempt to exchange the code for a
            token. The Relying Party makes a authorization grant POST request to the Host's
            tokenUri, as declared in the Host's Badge Connect <a href="#api-manifest">Manifest</a>. This request is
            authenticated using the "Using JSON Web Tokens with OAuth 2.0 Authorization Code Grant"
            method described in the IMS Security Framework. The Relying Party generates an RSA256 signed JWT
            [[!RFC7519]] to be passed in the request body's <code>client_assertion</code> parameter along with a predefined <code>client_assertion_type</code> of <code>urn:ietf:params:oauth:client-assertion-type:jwt-bearer</code></p>
            <p>An example token request:</p>
<pre><code>
POST /badge/connect/auth/token HTTP/1.1
Host: www.example.com
Content-Type: application/x-www-form-urlencoded

grant_type=authorization_code
&code=n0esc3NRze7LTCu7iYzS6a5acc3f0ogp4
&client_assertion_type=urn%3Aietf%3Aparams%3Aoauth%3Aclient-assertion-type%3Ajwt-bearer
&client_assertion=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9
.eyJpc3MiOiJ0b29sLmNvbSIsInN1YiI6Ind3dy5leGFtcGxlLmNvbSIsImF1ZCI6Imh0dHBzOi8vd3d3LmV4YW1wbGUuY29tL2x0aS9hdXRoL3R
va2VuIiwiaWF0IjoiMTQ4NTkwNzIwMCIsImV4cCI6IjE0ODU5MDc1MDAiLCJqdGkiOiIyOWY5MGMwNDdhNDRiMmVjZTczZDAwYTA5MzY0ZDQ5YiJ9
.liArqLDIF-xGcCu8ythy0HlzntxwZ90AYTnwH-daCQQ
</code></pre>
  			<p>The authorization server decodes the JWT and checks the <code>iss</code>,
  				<code>sub</code>,
  				<code>exp</code>, <code>aud</code> and <code>jti</code> values, followed
  				by verifying the signature using the <code>kid</code> and <a href="#api-jwks">JWKS file</a>. If it finds the request to be a valid, it generates
  				and returns an access token and optionally a refresh token.</p>

            <p>If the request is invalid, the Host MUST return an error message with an HTTP 400 (Bad Request) status
            code and a body matching the Badge Connect response <a href="#envelope">envelope</a>.
          </p>
        </section>
        <section id="oauth-token">
          <h3>Authenticating with Tokens</h3>
          <p>After obtaining a token using the above method, a Relying Party MAY request resources
            controlled by the resource owner from Host endpoints using the token in the HTTP
            Authorization header. An example follows, where <code>2YotnFZFEjr1zCsicMWpAA</code> is
            the token:</p>
          <pre>Authorization: Bearer 2YotnFZFEjr1zCsicMWpAA</pre>
        </section>
        <section id="oauth-token">
            <h3>Revocation by Resource Owner</h3>
            <p>Host platforms MUST provide a list of authorized clients to the resource owner for review. The list SHOULD identify the relying party and when the grant was created. From this list the resource owner MUST be able to revoke the relying party's access.</p>
            <p>Subsequent attempts to use the relevant revoked access or refresh tokens SHOULD result in a 401 UNAUTHENTICATED error.</p>
        </section>
      </section>

      <section id="api-scopes">
        <h3>Scopes</h3>
        <p>Access to resources in the Badge Connect API require an access token. These access
          tokens have a permissioned scope when they are created and inform the responding
          application which resources the entity has access to.
        </p>
        <table title="Scopes for the Badge Connect API endpoints." summary="Scopes for the Badge Connect API endpoints.">
          <thead>
            <tr>
              <td>Name</td>
              <td>Description</td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>assertion.readonly</td>
              <td>Permission to read assertions for the authenticated entity.</td>
            </tr>
            <tr>
              <td>assertion.create</td>
              <td>Permission to create assertions for the authenticated entity.</td>
            </tr>
            <tr>
              <td>profile.readonly</td>
              <td>Permission to read the profile for the authenticated entity.</td>
            </tr>
            <tr>
              <td>profile.update</td>
              <td>Permission to update the profile for the authenticated entity.</td>
            </tr>
          </tbody>
        </table>
      </section>

    <section id="api-manifest">
        <h3>Manifest</h3>
        <p>All Hosts and Relying Parties MUST implement a JSON manifest file
          which contains configuration information about their implementation,
          such as scope support, redirect URIs, and branding information.</p>
        <p>Platforms MUST serve the manifest at the path
          <code>/.well-known/badgeconnect.json</code> on the relevant service
          domain. The manifest must only be provided over secure TLS protocol.
            E.g. <code>https://YOUR_DOMAIN/.well-known/badgeconnect.json</code>
        </p>

        <h4>Requesting Manifests</h4>
        <p>Upon requesting a Manifest file from either a Host or Relying Party,
          the requester SHOULD respect the <code>Cache-Control</code> and
          <code>Expires</code> headers if present in the response and configure
          local cache to match the directives it declares. If directives include
          one of <code>no-cache, no-store</code>, the requester SHOULD NOT cache
          the data for future interactions. If directies include
          <code>max-age</code> or if an <code>Expires</code> header is present,
          the requester SHOULD cache the manifest file data if valid up to the
          expiration indicated, either at the time indicated by the Expires
          header or max-age seconds from request time.
        </p>
        <p>An <code>Etag</code> header MAY be offered with the Manifest file
          response. If so, after a resource's declared expiration, a requester
          MAY include an <code>If-None-Match</code> header containing the value
          of the Etag to check if the resource is still fresh. If so the server
          may return a <code>304 Not Modified</code> response status code, and a
          new <code>Expires</code> or <code>Cache-Control</code> header MAY be
          included, which the requester SHOULD use to update the cache expiration.
        </p>
        <h4>Manifest Structure</h4>
        <pre>
{
  "@context": "to/be/determined/location/context.json",
  "id": "https://badgehost.example.com/.well-known/badgeconnect.json",
  "badgeConnectAPI": [{
    "name": "A Badge Host",
    "image": "https://badgehost.example.com/logo.png",
    "apiBase": "https://badgehost.example.com/api/obc/v1",
    "version": "v1p0",
    "termsOfServiceUrl": "https://badgehost.example.com/terms",
    "privacyPolicyUrl": "https://badgehost.example.com/privacy",
    "scopesOffered": [
      "https://purl.imsglobal.org/spec/obc/v1p0/oauth2scope/assertion.readonly",
      "https://purl.imsglobal.org/spec/obc/v1p0/oauth2scope/assertion.create",
      "https://purl.imsglobal.org/spec/obc/v1p0/oauth2scope/profile.readonly",
      "https://purl.imsglobal.org/spec/obc/v1p0/oauth2scope/profile.patch"
    ],
    "scopesRequested": [
      "https://purl.imsglobal.org/spec/obc/v1p0/oauth2scope/assertion.readonly",
      "https://purl.imsglobal.org/spec/obc/v1p0/oauth2scope/assertion.create",
      "https://purl.imsglobal.org/spec/obc/v1p0/oauth2scope/profile.readonly",
      "https://purl.imsglobal.org/spec/obc/v1p0/oauth2scope/profile.patch"
    ],
    "authorizationUrl": "https://badgehost.example.com/o/auth",
    "tokenUrl": "https://badgehost.example.com/o/token",
    "redirectUris": [
      "https://badgehost.example.com/o/redirect"
    ],
    "keys": "https://badgehost.example.com/.well-known/jwks.json"
  }]
}
        </pre>

        <h4>Manifest Properties</h4>

        <table title="Properties for the manifest file." summary="Properties for the manifest file.">
          <thead>
            <tr>
              <td>Property</td>
              <td>Required</td>
              <td>Description</td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><code>name</code></td>
              <td>Yes</td>
              <td>The name of the platform supporting the API. This SHOULD reflect the user-facing identity of the platform requesting authorization.</td>
            </tr>
            <tr>
              <td><code>image</code></td>
              <td>No</td>
              <td>An image representing the platform. May be a URI to a hosted image or a Data URI.</td>
            </tr>
            <tr>
              <td><code>apiBase</code></td>
              <td>Yes</td>
              <td>Fully qualified URL that will be concatenated with the API endpoints. It SHOULD NOT have a trailing slash "/". <br />
                  E.g. <code>apiBase + "/assertions"</code>
              </td>
            </tr>
            <tr>
              <td><code>version</code></td>
              <td>Yes</td>
              <td>A string representing the implemented version. MUST be in the format of <code>vMAJORpMINOR</code> where <strong>MAJOR</strong> and <strong>MINOR</strong> are integers.</td>
            </tr>
            <tr>
              <td><code>termsOfServiceUrl</code></td>
              <td>Yes</td>
              <td>Fully qualified URL to the platform's terms of service. Other platforms SHOULD link to this resource as part of their authorization interface.</td>
            </tr>
            <tr>
              <td><code>privacyPolicyUrl</code></td>
              <td>Yes</td>
              <td>Fully qualified URL to the platform's privacy policy. Other platforms SHOULD link to this resource as part of their authorization interface.</td>
            </tr>
            <tr>
              <td><code>scopesOffered</code></td>
              <td>Yes*</td>
              <td><strong>Applies to Hosts only.</strong> An array of strings listing the scopes supported by the Host in the form of fully qualified URLs to the scope descriptors.</td>
            </tr>
            <tr>
              <td><code>scopesRequested</code></td>
              <td>Yes*</td>
              <td><strong>Applies to Relying Parties only.</strong> An array of strings listing the scopes supported by the relying party in the form of fully qualified URLs to the scope descriptors.</td>
            </tr>
            <tr>
              <td><code>authorizationUrl</code></td>
              <td>Yes*</td>
              <td><strong>Applies to Hosts only.</strong> A fully qualified URL to the host's authorization endpoint.</td>
            </tr>
            <tr>
              <td><code>tokenUrl</code></td>
              <td>Yes*</td>
              <td><strong>Applies to Hosts only.</strong> A fully qualified URL to the host's token request endpoint for exchanging an authorization code for a bearer token.</td>
            </tr>
            <tr>
              <td><code>redirectUris</code></td>
              <td>Yes*</td>
              <td><strong>Applies to Relying Parties only.</strong> An array of one or more fully qualified URIs representing the valid redirect values for authorization requests. The HOST MUST reject any authorization requests with redirect URIs that are not an exact match of a registered URI</td>
            </tr>
            <tr>
              <td><code>keys</code></td>
              <td>No</td>
              <td><strong>Applies to Relying Parties only.</strong> Allows the relying party to declare the location of their JWKS file. Currently this file MUST be named <code>jwks.json</code> and placed in the <code>.well-known</code> directory. E.g. <code>https://YOUR_DOMAIN/.well-known/jwks.json</code>.</td>
            </tr>
          </tbody>
        </table>

    </section>

    <section id="api-jwks">
        <h3>JSON Web Key Set</h3>
        <p>A JWKS file is a container of one or multiple <strong>public</strong> keys identified by their key identifier (<code>kid</code> key parameter), in the form of a JSON Web Key. [[!RFC7517]] defines JSON Web Keys.</p>
        <p>Relying parties MUST name their set <code>jwks.json</code> and place it in the <code>.well-known</code> directory. E.g. <code>https://YOUR_DOMAIN/.well-known/jwks.json</code></p>
        <p>When a Relying Party requests a token, they MUST sign the JWT passed in the <code>client_assertion</code> with an RSA256 signature. The Relying Party identifies the key a Host uses to validate the
          JWT signature by using a <code>kid</code> claim in the JWT header. The Relying Party MUST NOT reuse the <code>kid</code> identifier to identify different public keys, allowing the public key to optionally be cached by the Host.
          The relying party MAY issue a <code>cache-control: max-age</code> HTTP header on requests to retrieve a key set to signal how long the retriever may cache the key set before refreshing it.
        </p>
        <p>Here is an example of a JWK Set containing two RSA keys:</p>
        <pre><code>
  {
      "keys": [{
          "e": "AQAB",
          "use": "sig",
          "alg": "RS256",
          "kty": "RSA",
          "n": "oNqXxxWuX7LlovO5reRNau5f96K_o3DJx-wK7lrjBmp0qKwNszbbp8MvfrlVs-oYXfj1rzqAeY6GJF5BETViDTT0i2fEz37J0HGAeTrO7Z5zI5Ure9Cb0lulLOZj1hF8piZzWW_z_set2NyhafoZ-IG1NSe61mqHu7mTjuHYST84igz-bPKhkJAVlmPPjHTO51hG9T_roVIkjXnvgqd2dCaJ0ExT2bR96jcyausbkdDNfPtJdfSCAWYXGQnt0PmIysOHPtCkyFqv5ez8KXT7Q4CAYd7nxwfWNOFRHyLAyF__cYEJlBEKGyJniSIPtkGBWrbXUQhKF6TEFa-RRRl8Dw==",
          "kid": "1516918956_0"
      }, {
          "e": "AQAB",
          "use": "sig",
          "alg": "RS256",
          "kty": "RSA",
          "n": "kMfHwTp2dIYybtvU-xzF2E3dRJBNBtNbb-d3-Rm6nRUraxnTwZ6Fr1YpFBd1pnWzLzdtMv7ofCd28nx-1mfYZ6qhqPWF1RpGe2vVOSTmcu-QpA9h-rouqRKlv3jvXPn623Z2U1Wml0EIxyIzD3WLu7NkWEKSIcBzeY1TctpO5FSU3EyyCX1UoIMuvYBP9tiZlc74yIZvky-qT8Ej3S8L0JqhvD583E_uGMoLowguOl2yYr9zhubiqOxT3VsxvpJCu04TWmvf4XX34IQRyAHcPJFQ2QiBfLWvWyc6iP3JJYJvyapwc5vVEismryXnngyBX8NXHZaarMi6g5kTQi8itw==",
          "kid": "1516918956_1"
      }]
  }
  </code></pre>

    <p>Here is a quick breakdown of what each property represents:</p>
    <ul>
        <li><strong>e</strong>: is the exponent for a standard PEM</li>
        <li><strong>use</strong>: is how the key was meant to be used. For the example above sig represents signature.</li>
        <li><strong>alg</strong>: is the algorithm for the key</li>
        <li><strong>kty</strong>: is the key type</li>
        <li><strong>n</strong>: is the modulus for a standard PEM</li>
        <li><strong>kid</strong>: is the unique identifier for the key</li>
    </u>
    </section>

      <section id="api-envelope">
        <h3>Envelope</h3>
        <p>Responses from all APIs in this document are wrapped in a JSON envelope.</p>
          <pre>
{
    "status": {
        "error": null,
        "statusCode": 200,
        "statusText": "OK"
    },

    "results": [
        {
          "@context":"https://w3id.org/openbadges/v2",
          "id":"https://issuer.example.com/api/v20/assertion/1234567",
          "type":"Assertion"
        }
    ]
}
          </pre>
        <section id="api-envelope-pagination">
          <h4>Pagination</h4>
          <p>Pagination is controlled by two query string parameters appended to the request.</p>
          <ul>
            <li><code>limit</code> - the number of results to return</li>
            <li><code>offset</code> - the index of the first record to return (zero indexed)</li>
          </ul>
          <p>The HTTP <code>Link</code> header MUST appear when a list response is incomplete and MAY appear for complete responses.</p>
          <p>It is RECOMMENDED that Host implementations pass the total result count back to the requester. When the total result count is not known, this MUST be omitted. The value MUST be provided in the custom HTTP header: <code>X-Total-Count</code>.</p>
          <p>The header MUST support all of the following link relations (<code>rel</code> values):</p>
          <table>
            <thead>
              <tr>
                <td>Name</td>
                <td>Description</td>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>next</td>
                <td>The link relation for the immediate next page of results. This MUST appear when the current list response is incomplete.</td>
              </tr>
              <tr>
                <td>last</td>
                <td>The link relation for the last page of results. This MUST always appear.</td>
              </tr>
              <tr>
                <td>first</td>
                <td>The link relation for the first page of results. This MUST always appear.</td>
              </tr>
              <tr>
                <td>prev</td>
                <td>The link relation for the immediate previous page of results. This MUST appear when the offset is greater than zero.</td>
              </tr>
            </tbody>
          </table>
          <p>An example of Link header pagination, line breaks added for readability:</p>
          <pre>
Link:
&lt;https://host.example.com/v1/assertions?limit=10&offset=20&gt;; rel="next",
&lt;https://host.example.com/v1/assertions?limit=3&offset=500&gt;; rel="last",
&lt;https://host.example.com/v1/assertions?limit=10&offset=0&gt;; rel="first",
&lt;https://host.example.com/v1/assertions?limit=10&offset=0&gt;; rel="prev"
          </pre>
        </section>
        <section id="api-envelope-status">
          <h4>Status</h4>
          <p>The "status" property MUST appear on all responses.</p>
          <table>
            <thead>
              <tr>
                <td>Name</td>
                <td>Description</td>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>error</td>
                <td>A nullable string and the human-readable message describing the problem.</td>
              </tr>
              <tr>
                <td>statusCode</td>
                <td>The HTTP status code of the response.</td>
              </tr>
              <tr>
                <td>statusText</td>
                <td>A string matching one of the enumerated and allowed values for the given endpoint.</td>
              </tr>
            </tbody>
          </table>
        </section>
        <section id="api-envelope-results">
          <h4>Results</h4>
          <p>A list of zero or more documents responsive to the request.</p>
        </section>
      </section>
      <section id="api-endpoints">
        <h3>Endpoints</h3>
        <section id="api-endpoints-assertion">
          <h4>Assertions</h4>
          <table class="openAPIPathsTable" title="The Set of HTTP Verbs and Parameters for the '/assertions' Path" summary="The permitted set of HTTP verbs and path/query parameters for the '/assertions' path.">
            <thead>
                <tr>
                    <th colspan="2">GET /assertions</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>Description</td>
                    <td>Fetch Assertions for the supplied parameters and authentication token. The result parameter MUST be a list of zero or more matching Assertions which may be JSON-LD Assertion documents or JSON Web Signatures. There SHOULD be only one result for a particular requested ID as the IDs are intended to be globally unique. The Host SHOULD return Assertions ordered by last update, descending and SHOULD return only Assertions updated after the timestamp requested if supplied.</td>
                </tr>
                <tr>
                    <td>Query Parameters</td>
                    <td>
                      <table class="openAPIResponsesTable" title="GET /assertions Permitted Query Parameters" summary="The description of the permitted query parameters for the GET /assertions operation.">
                        <thead>
                          <tr>
                            <th>Name</th>
                            <th>Type</th>
                            <th>Description</th>
                          </tr>
                        </thead>
                        <tbody>
                          <tr>
                            <td>limit</td>
                            <td>Integer</td>
                            <td>Indicate how many results should be retrieved in a single page.</td>
                          </tr>
                          <tr>
                            <td>offset</td>
                            <td>Integer</td>
                            <td>Indicate the index of the first record to return (zero indexed).</td>
                          </tr>
                          <tr>
                            <td>since</td>
                            <td>An <a href="http://en.wikipedia.org/wiki/ISO_8601">ISO 8601</a> compatible timestamp with a time zone indicator.</td>
                            <td>Retrieve Assertions that were created or updated after the provided timestamp.</td>
                          </tr>
                        </tbody>
                      </table>
                    </td>
                </tr>
                <tr>
                    <td>Responses</td>
                    <td>
                        <table class="openAPIResponsesTable" title="GET /assertions Permitted Endpoint Responses" summary="The description of the permitted endpoint responses for the GET /assertions operation.">
                            <thead>
                                <tr>
                                    <th>Name</th>
                                    <th>Type</th>
                                    <th>Description</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>200</td>
                                    <td><a href="#api-responses-get-assertions-200">Assertions Response</a></td>
                                    <td>This is the response when the request has been completed successfully.</td>
                                </tr>
                                <tr>
                                    <td>400</td>
                                    <td><a href="#api-responses-400">400 Response</a></td>
                                    <td>An invalid request was made.</td>
                                </tr>
                                <tr>
                                    <td>401</td>
                                    <td><a href="#api-responses-401">401 Response</a></td>
                                    <td>The request was not correctly authorized.</td>
                                </tr>
                                <tr>
                                    <td>404</td>
                                    <td><a href="#api-responses-404">404 Response</a></td>
                                    <td>The requested resource does not exist.</td>
                                </tr>
                                <tr>
                                    <td>405</td>
                                    <td><a href="#api-responses-405">405 Response</a></td>
                                    <td>This method is not allowed on the endpoint.</td>
                                </tr>
                                <tr>
                                    <td>500</td>
                                    <td>-</td>
                                    <td>This code should be used only if there is catastrophic error.</td>
                                </tr>
                            </tbody>
                        </table>
                    </td>
                </tr>
            </tbody>
          </table>
          <table class="openAPIPathsTable" title="The Set of HTTP Verbs and Parameters for the '/assertions' Path" summary="The permitted set of HTTP verbs and path/query parameters for the '/assertions' path.">
            <thead>
                <tr>
                    <th colspan="2">POST /assertions</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>Description</td>
                    <td>Create or update an Assertion. Multiple Assertions are not allowed. Data MUST be a list exactly one Assertion long. JWS-signed Assertions must be represented in the JSON serialization option.</td>
                </tr>
                <tr>
                    <td>Responses</td>
                    <td>
                        <table class="openAPIResponsesTable" title="POST /assertions Permitted Endpoint Responses" summary="The description of the permitted endpoint responses for the POST /assertions operation.">
                            <thead>
                                <tr>
                                    <th>Name</th>
                                    <th>Type</th>
                                    <th>Description</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>200</td>
                                    <td><a href="#api-responses-post-assertions-200">Assertion Response</a></td>
                                    <td>This is the response when the request has been completed successfully.</td>
                                </tr>
                                <tr>
                                    <td>400</td>
                                    <td><a href="#api-responses-400">400 Response</a></td>
                                    <td>An invalid request was made.</td>
                                </tr>
                                <tr>
                                    <td>401</td>
                                    <td><a href="#api-responses-401">401 Response</a></td>
                                    <td>The request was not correctly authorized.</td>
                                </tr>
                                <tr>
                                    <td>404</td>
                                    <td><a href="#api-responses-404">404 Response</a></td>
                                    <td>The requested resource does not exist.</td>
                                </tr>
                                <tr>
                                    <td>405</td>
                                    <td><a href="#api-responses-405">405 Response</a></td>
                                    <td>This method is not allowed on the endpoint.</td>
                                </tr>
                                <tr>
                                    <td>500</td>
                                    <td>-</td>
                                    <td>This code should be used only if there is catastrophic error.</td>
                                </tr>
                            </tbody>
                        </table>
                    </td>
                </tr>
            </tbody>
          </table>
        </section>
        <section id="api-endpoints-profile">
          <h4>Profile</h4>
          <table class="openAPIPathsTable" title="The Set of HTTP Verbs and Parameters for the '/profile' Path" summary="The permitted set of HTTP verbs and path/query parameters for the '/profile' path.">
            <thead>
                <tr>
                    <th colspan="2">GET /profile</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>Description</td>
                    <td>Fetch the profile for the supplied authentication token. For a successful result, the Host MUST return exactly one entry in the results list that is a valid OB Profile instance. Multiple values MAY be present for each of the profile identifier properties other than "id": email, url, and telephone.</td>
                </tr>
                <tr>
                    <td>Responses</td>
                    <td>
                        <table class="openAPIResponsesTable" title="GET /profile Permitted Endpoint Responses" summary="The description of the permitted endpoint responses for the GET /profile operation.">
                            <thead>
                                <tr>
                                    <th>Name</th>
                                    <th>Type</th>
                                    <th>Description</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>200</td>
                                    <td><a href="#api-responses-get-profile-200">Profile Response</a></td>
                                    <td>This is the response when the request has been completed successfully.</td>
                                </tr>
                                <tr>
                                    <td>400</td>
                                    <td><a href="#api-responses-400">400 Response</a></td>
                                    <td>An invalid request was made.</td>
                                </tr>
                                <tr>
                                    <td>401</td>
                                    <td><a href="#api-responses-401">401 Response</a></td>
                                    <td>The request was not correctly authorized.</td>
                                </tr>
                                <tr>
                                    <td>404</td>
                                    <td><a href="#api-responses-404">404 Response</a></td>
                                    <td>The requested resource does not exist.</td>
                                </tr>
                                <tr>
                                    <td>405</td>
                                    <td><a href="#api-responses-405">405 Response</a></td>
                                    <td>This method is not allowed on the endpoint.</td>
                                </tr>
                                <tr>
                                    <td>500</td>
                                    <td>-</td>
                                    <td>This code should be used only if there is catastrophic error.</td>
                                </tr>
                            </tbody>
                        </table>
                    </td>
                </tr>
            </tbody>
          </table>
          <table class="openAPIPathsTable" title="The Set of HTTP Verbs and Parameters for the '/profile' Path" summary="The permitted set of HTTP verbs and path/query parameters for the '/profile' path.">
            <thead>
                <tr>
                    <th colspan="2">POST /profile</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>Description</td>
                    <td>Update the profile for the authenticate entity. The request SHOULD only include profile identifier properties to be added to the profile, not any existing data. Successful request responses will be the same as GET Profile and may not include the patched values (as the Host may be waiting for asynchronous processes to complete before accepting the value). The value may never become part of the published profile. A Host MAY respond with 400 BAD_REQUEST to reject data that is known immediately to not be acceptable by the platform, e.g. to reject a "telephone" property if the Host cannot validate telephone numbers.</td>
                </tr>
                <tr>
                    <td>Responses</td>
                    <td>
                        <table class="openAPIResponsesTable" title="POST /profile Permitted Endpoint Responses" summary="The description of the permitted endpoint responses for the POST /profile operation.">
                            <thead>
                                <tr>
                                    <th>Name</th>
                                    <th>Type</th>
                                    <th>Description</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>200</td>
                                    <td><a href="#api-responses-post-profile-200">Profile Response</a></td>
                                    <td>This is the response when the request has been completed successfully.</td>
                                </tr>
                                <tr>
                                    <td>400</td>
                                    <td><a href="#api-responses-400">400 Response</a></td>
                                    <td>An invalid request was made.</td>
                                </tr>
                                <tr>
                                    <td>401</td>
                                    <td><a href="#api-responses-401">401 Response</a></td>
                                    <td>The request was not correctly authorized.</td>
                                </tr>
                                <tr>
                                    <td>404</td>
                                    <td><a href="#api-responses-404">404 Response</a></td>
                                    <td>The requested resource does not exist.</td>
                                </tr>
                                <tr>
                                    <td>405</td>
                                    <td><a href="#api-responses-405">405 Response</a></td>
                                    <td>This method is not allowed on the endpoint.</td>
                                </tr>
                                <tr>
                                    <td>500</td>
                                    <td>-</td>
                                    <td>This code should be used only if there is catastrophic error.</td>
                                </tr>
                            </tbody>
                        </table>
                    </td>
                </tr>
            </tbody>
          </table>
        </section>
      </section>
      <section id="api-retrybehavior">
        <h3>Retry Behavior</h3>
        <p>Receivers of requests MAY implement a <strong>Retry-After</strong> header to indicate a period of time to wait before attempting the request again.</p>
        <p>If no <strong>Retry-After</strong> header is present and the response is non-2XX, it is recommended to retry the request in 30 minutes for an additional two attempts. After which, it MAY be desirable to alert the recipient that there is an issue with the connection (e.g. perhaps they need to reauthenticate or manually trigger the request when they believe services are back up).</p>
      </section>
      <section id="api-responses">
        <h3>Responses</h3>
        <section id="api-responses-get-assertions-200">
          <h4>200 GET Assertions Response</h4>
          <pre>
{
    "status": {
        "error": null,
        "statusCode": 200,
        "statusText": "OK"
    },

    "results": [
        {
          "@context":"https://w3id.org/openbadges/v2",
          "id":"https://issuer.example.com/api/v20/assertion/1234567",
          "type":"Assertion"
        },
        "eyJhbGciOiJSUzI1NiJ9.ew0KICAiQGNvbnRleHQiOiAiaHR0cHM6Ly93M2lkLm9yZy9vcGVuYmFkZ2VzL3YyIiwNCiAgInR5cGUiOiAiQXNzZXJ0aW9uIiwNCiAgImlkIjogImh0dHBzOi8vZXhhbXBsZS5vcmcvYmV0aHMtcm9ib3RpY3MtYmFkZ2UuanNvbiIsDQogICJyZWNpcGllbnQiOiB7DQogICAgInR5cGUiOiAiZW1haWwiLA0KICAgICJoYXNoZWQiOiB0cnVlLA0KICAgICJzYWx0IjogImRlYWRzZWEiLA0KICAgICJpZGVudGl0eSI6ICJzaGEyNTYkYzdlZjg2NDA1YmE3MWI4NWFjZDhlMmU5NTE2NmM0YjExMTQ0ODA4OWYyZTE1OTlmNDJmZTFiYmE0NmU4NjVjNSINCiAgfSwNCiAgImltYWdlIjogImh0dHBzOi8vZXhhbXBsZS5vcmcvYmV0aHMtcm9ib3QtYmFkZ2UucG5nIiwNCiAgImV2aWRlbmNlIjogImh0dHBzOi8vZXhhbXBsZS5vcmcvYmV0aHMtcm9ib3Qtd29yay5odG1sIiwNCiAgImlzc3VlZE9uIjogIjIwMTYtMTItMzFUMjM6NTk6NTlaIiwNCiAgImJhZGdlIjogImh0dHBzOi8vZXhhbXBsZS5vcmcvcm9ib3RpY3MtYmFkZ2UuanNvbiIsDQogICJ2ZXJpZnkiOiB7DQogICAgInR5cGUiOiAiU2lnbmVkQmFkZ2UiLA0KICAgICJjcmVhdG9yIjogImh0dHBzOi8vZXhhbXBsZS5vcmcvcHVibGljS2V5Ig0KICB9DQp9.Liv4CLviFH20_6RciUWf-jrUvMAecxT4KZ_gLHAeT_chrsCvBEE1uwgtwiarIs9acFfMi0FJzrGye6mhdHf3Kjv_6P7BsG3RPkYgK6-5i9uZv4QAIlvfNclWAoWUt4j0_Kip2ftzzWwc5old01nJRtudZHxo5eGosSPlztGRE9G_g_cTj32tz3fG92E2azPmbt7026G91rq80Mi-9c4bZm2EgrcwNBjO0p1mbKYXLIAAkOMuJZ_8S4Go8S0Sg3xC6ZCn03zWuXCP6bdY_jJx2BpmvqC3H55xWIU8p5c9RxI8YifPMmJq8ZQhjld0pl-L8kHolJx7KGfTjQSegANUPg"
    ]
}
          </pre>
        </section>
        <section id="api-responses-post-assertions-200">
          <h4>200 POST Assertion Response</h4>
          <pre>
{
    "status": {
        "error": null,
        "statusCode": 200,
        "statusText": "OK"
    }
}
          </pre>
        </section>
        <section id="api-responses-get-profile-200">
          <h4>200 GET Profile Response</h4>
          <pre>
{
    "status": {
        "error": null,
        "statusCode": 200,
        "statusText": "OK"
    },

    "results": [
        {
            "@context": "https://w3id.org/openbadges/v2",
            "id": "https://host.example.com/profile/12345",
            "type": "Profile",
            "name": "John Appleseed ",
            "url": "https://example.com",
            "email": "john@example.com"
        }
    ]
}
          </pre>
        </section>
        <section id="api-responses-post-profile-200">
          <h4>200 POST Profile Response</h4>
          <pre>
{
    "status": {
        "error": null,
        "statusCode": 200,
        "statusText": "OK"
    },

    "results": [
        {
            "@context": "https://w3id.org/openbadges/v2",
            "id": "https://host.example.com/profile/12345",
            "type": "Profile",
            "name": "John Appleseed ",
            "url": "https://example.com",
            "email": "john@example.com"
        }
    ]
}
          </pre>
        </section>
        <section id="api-responses-400">
          <h4>400 Response</h4>
          <pre>
  {
      "status": {
          "error": "Additional information regarding the error in human readable format.",
          "statusCode": 400,
          "statusText": "BAD_REQUEST"
      }
  }
          </pre>
          <p>Allowed values for the statusText property by endpoint:</p>
          <ul>
            <li>
              <p>POST /assertions</li>
              <ul>
                <li>REQUEST_VALIDATION_ERROR (data validation of the request failed)</li>
                <li>RECIPIENT_PROFILE_MISMATCH (profile match failed)</li>
                <li>INVALID_BADGE (badge validation failed)</li>
                <li>BAD_REQUEST (all other errors)</li>
              </ul>
            </li>
            <li>
              <p>GET /assertions</li>
              <ul>
                <li>REQUEST_VALIDATION_ERROR (data validation of the request failed)</li>
                <li>BAD_REQUEST (all other errors)</li>
              </ul>
            </li>
            <li>
              <p>POST /profile</li>
              <ul>
                <li>REQUEST_VALIDATION_ERROR (data validation of the request failed)</li>
                <li>BAD_REQUEST (all other errors)</li>
              </ul>
            </li>
          </ul>
        </section>
        <section id="api-responses-401">
          <h4>401 Response</h4>
          <pre>
  {
      "status": {
          "error": "Additional information regarding the error in human readable format.",
          "statusCode": 401,
          "statusText": "UNAUTHENTICATED"
      }
  }
          </pre>
          <p>PERMISSION_DENIED is another acceptable value for statusText in the event that the request was authenticated but the scope does not include the requested resource.</p>
        </section>
        <section id="api-responses-404">
          <h4>404 Response</h4>
          <pre>
  {
      "status": {
          "error": null,
          "statusCode": 404,
          "statusText": "NOT_FOUND"
      }
  }
          </pre>
        </section>
        <section id="api-responses-405">
          <h4>405 Response</h4>
          <pre>
  {
      "status": {
          "error": "Additional information regarding the error in human readable format.",
          "statusCode": 405,
          "statusText": "METHOD_NOT_ALLOWED"
      }
  }
          </pre>
        </section>
      </section>
    </section>

    <section class="appendix informative" id="revisionhistory">
      <h2>Revision History</h2>
      <section>
        <h3>Version History</h3>
        <table title="Revision History"
          summary="Publication history and revision details for this specification.">
          <thead>
            <tr><th>Version No.</th><th>Release Date</th><th>Comments</th></tr>
          </thead>
            <tbody>
                <tr>
                    <td>IMS Base Document 1.0</td>
                    <td>Month Day, 2018</td>
                    <td>The first draft release. This document.</td>
                </tr>
            </tbody>
        </table>
       </section>
       <section>
         <h3>Changes in this version</h3>
         <p>Changes in this version of Example Specification are detailed below.</p>
         <p><em>Table with list of changes since previous version</em></p>
       </section>
    </section> <!-- /revision history -->

    <!-- a footer is inserted by the script -->
  </body>
</html>
